<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Cliff Shaffer" />
  <meta name="author" content="Peter Ljunglöf" />
  <meta name="author" content="Nick Smallbone" />
  <title>DSABook – Insertion Sort</title>
  <link rel="stylesheet" href="../css/main.css" />
  <link rel="stylesheet" href="../css/book.css" />
  <link rel="stylesheet" href="../css/code.css" />
  <link rel="stylesheet" href="../css/quiz.css" />
  <link rel="stylesheet" href="../css/mobile.css" />
  <link rel="stylesheet" href="../css/print.css" />
  
  <link rel="stylesheet" href="../lib/JSAV.css" type="text/css" />
  <link rel="stylesheet" href="../lib/odsaMOD.css" type="text/css" />
  <link rel="stylesheet" href="../lib/jquery.ui.min.css" type="text/css" />
  <link rel="stylesheet" href="../lib/odsaStyle.css" type="text/css" />
  <link rel="stylesheet" href="../lib/ChalmersGU-interactive.css" type="text/css" />

  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.4.1',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
      },
      "HTML-CSS": {
        scale: "80",
      }
    });
  </script>

  <script type="text/javascript" src="../lib/jquery.min.js"></script>
  <script type="text/javascript" src="../lib/jquery.migrate.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/javascript" src="../lib/localforage.min.js"></script>
  <script type="text/javascript" src="../lib/accessibility.js"></script>
  <script type="text/javascript" src="../lib/jquery.ui.min.js"></script>
  <script type="text/javascript" src="../lib/jquery.transit.js"></script>
  <script type="text/javascript" src="../lib/raphael.js"></script>
  <script type="text/javascript" src="../lib/JSAV.js"></script>
  <script type="text/javascript" src="../lib/config.js"></script>
  <script type="text/javascript" src="../lib/timeme.js"></script>
  <script type="text/javascript" src="../lib/odsaUtils.js"></script>
  <script type="text/javascript" src="../lib/odsaMOD.js"></script>
  <script type="text/javascript" src="../lib/d3.min.js"></script>
  <script type="text/javascript" src="../lib/d3-selection-multi.v1.min.js"></script>
  <script type="text/javascript" src="../lib/dataStructures.js"></script>
  <script type="text/javascript" src="../lib/conceptMap.js"></script>

  <script>
    ODSA.SETTINGS.MODULE_SECTIONS = [
    'internal-variables', 
    'getting-and-setting-values', 
    'adding-elements', 
    'add-practice-exericse', 
    'removing-elements', 
    'remove-practice-exericise', 
    'static-array-based-list-summary-questions', 
    'static-array-based-list:-full-code',
    ];
    ODSA.SETTINGS.MODULE_NAME = "DSABook";
    ODSA.SETTINGS.MODULE_LONG_NAME = "Data Structures and Algorithms";
    JSAV_OPTIONS['lang']='en';
    JSAV_EXERCISE_OPTIONS['code']='pseudo';
  </script>

  
  <script type="text/javascript" src="../scripts/quizhandler.js"></script>
<link href="../interactive/Sorting/InsertionSortWorstCaseCON.css" rel="stylesheet" type="text/css"/>
<link href="../interactive/Sorting/InsertionSortBestCaseCON.css" rel="stylesheet" type="text/css"/>
<link href="../interactive/Sorting/InsertionSortAverageCaseCON.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<header>
<nav class="sitenav">
<div class="navlink"></div>
<h1 class="navlink navbutton"><a href="index.html" accesskey="t" rel="top">Data Structures and Algorithms</a></h1>
<div class="navlink"></div>
</nav>
<nav class="sitenav">
<div class="navlink">
<a href="2.3-sorting-terminology-and-notation.html" class="navbutton">&lt;&lt;</a>
<a href="2.3-sorting-terminology-and-notation.html" accesskey="p" rel="previous">Sorting Terminology and Notation</a>
</div>
<div class="navlink">
<a href="2.5-bubble-sort-optional.html" accesskey="n" rel="next">Bubble Sort (optional)</a>
<a href="2.5-bubble-sort-optional.html" class="navbutton">&gt;&gt;</a>
</div>
</nav>
</header>

<main>
<section id="insertion-sort" class="level2" data-number="2.4">
<h2 data-number="2.4"><span class="header-section-number">2.4</span>
Insertion Sort</h2>
<p>What would you do if you have a stack of phone bills from the past
two years and you want to order by date? A fairly natural way to handle
this is to look at the first two bills and put them in order. Then take
the third bill and put it into the right position with respect to the
first two, and so on. As you take each bill, you would add it to the
sorted pile that you have already made. This simple approach is the
inspiration for our first sorting algorithm, called <a
href="2.4-insertion-sort.html#insertion-sort" class="term"
title="A sorting algorithm with $\Theta(n^2)$ average and worst case cost, and $Theta(n)$ best case cost. This best case cost makes it useful when we have reason to expect the input to be nearly sorted.">Insertion
Sort</a>.</p>
<p>Insertion Sort iterates through a list of records. For each
iteration, the current record is inserted in turn at the correct
position within a sorted list composed of those records already
processed. Here is an implementation. The input is an array named
<code>A</code> that stores
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
records.</p>
<div id="introduction">
<div class="sourceCode" id="cb1"><pre
class="sourceCode pseudo"><code class="sourceCode pseudo"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> insertionSort(A):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="op">=</span> <span class="dv">1</span> <span class="kw">to</span> A.<span class="bu">size</span>()<span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Move the i&#39;th element to its correct position.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> i</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> j <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> A[j] <span class="op">&lt;</span> A[j<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            swap(A, j, j<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> j<span class="op">-</span><span class="dv">1</span></span></code></pre></div>
</div>
<div id="practice">
<p>(Note that to make the explanation for these sorting algorithms as
simple as possible, our visualizations will show the array as though it
stored simple integers rather than more complex records. But you should
realize that in practice, there is rarely any point to sorting an array
of simple integers. Nearly always we want to sort more complex records
that each have a <a href="10-glossary.html#key" class="term"
title="A field or part of a larger record used to represent that record for the purpose of searching or comparing. Another term for search key.">key</a>
value. In such cases we must have a way to associate a key value with a
record. The sorting algorithms will simply assume that the records are
<a href="10-glossary.html#comparable" class="term"
title="The concept that two objects can be compared to determine if they are equal or not, or to determine which one is greater than the other. In set notation, elements $x$ and $y$ of a set are comparable under a given relation $R$ if either $xRy$ or $yRx$. To be reliably compared for a greater/lesser relationship, the values being compared must belong to a total order. In programming, the property of a data type such that two elements of the type can be compared to determine if they are the same (a weaker version), or which of the two is larger (a stronger version). `Comparable` is also the name of an interface in Java that asserts a comparable relationship between objects within a class, and `.compareTo()` is the `Comparable` interface method that implements the actual comparison between two objects of the class.">comparable</a>.)</p>
</div>
<p>Here we see the first few iterations of Insertion Sort.</p>
<p>
<div id="insertionsortCON" class="ssAV" data-short-name="insertionsortCON" data-long-name="Insertion Sort Slideshow" alt="Insertion Sort Slideshow" tabIndex="-1">
<span class="jsavcounter"></span>
<div class="jsavcontrols"></div>
<p class="jsavoutput jsavline"></p>
<div class="jsavcanvas"></div>
</div>
</p>
<p>This continues on with each record in turn. Call the current record
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.
Insertion Sort will move it to the left so long as its value is less
than that of the record immediately preceding it. As soon as a key value
less than or equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is encountered, <code>insertionSort</code> is done with that record
because all records to its left in the array must have smaller keys.</p>
<p>
<div id="insertionsortAV" class="embedContainer">
<iframe id="insertionsortAV_iframe" aria-label="insertionsortAV" src="../interactive/Sorting/insertionsortAV.html" width="100%" height="600" scrolling="no">
Your browser does not support iframes.
</iframe>
</div>
</p>
<p>
<div id="InssortPRO" class="embedContainer">
<iframe id="InssortPRO_iframe" aria-label="InssortPRO" src="../interactive/Sorting/InssortPRO.html" width="100%" height="600" scrolling="no">
Your browser does not support iframes.
</iframe>
</div>
</p>
<section id="insertion-sort-analysis" class="level3"
data-number="2.4.1">
<h3 data-number="2.4.1"><span class="header-section-number">2.4.1</span>
Insertion Sort Analysis</h3>
<p>Here is an explanation of the worst case cost of insertion sort:</p>
<p>
<div id="InsertionSortWorstCaseCON" class="ssAV" data-short-name="InsertionSortWorstCaseCON" data-long-name="Insertion Sort Worst Case Slideshow" alt="Insertion Sort Worst Case Slideshow" tabIndex="-1">
<span class="jsavcounter"></span>
<div class="jsavcontrols"></div>
<p class="jsavoutput jsavline"></p>
<div class="jsavcanvas"></div>
</div>
</p>
<p>And here is an explanation of the cost of the best case:</p>
<p>
<div id="InsertionSortBestCaseCON" class="ssAV" data-short-name="InsertionSortBestCaseCON" data-long-name="Insertion Sort Best Case Slideshow" alt="Insertion Sort Best Case Slideshow" tabIndex="-1">
<span class="jsavcounter"></span>
<div class="jsavcontrols"></div>
<p class="jsavoutput jsavline"></p>
<div class="jsavcanvas"></div>
</div>
</p>
<p>And here is the average case cost:</p>
<p>
<div id="InsertionSortAverageCaseCON" class="ssAV" data-short-name="InsertionSortAverageCaseCON" data-long-name="Insertion Sort Average Case Slideshow" alt="Insertion Sort Average Case Slideshow" tabIndex="-1">
<span class="jsavcounter"></span>
<div class="jsavcontrols"></div>
<p class="jsavoutput jsavline"></p>
<div class="jsavcanvas"></div>
</div>
</p>
<p>While the best case is significantly faster than the average and
worst cases, the average and worst cases are usually more reliable
indicators of the “typical” running time. However, there are situations
where we can expect the input to be in sorted or nearly sorted order.
One example is when an already sorted list is slightly disordered by a
small number of additions to the list; restoring sorted order using
Insertion Sort might be a good idea if we know that the disordering is
slight. And even when the input is not perfectly sorted, Insertion
Sort’s cost goes up in proportion to the number of inversions. So a
“nearly sorted” list will always be cheap to sort with Insertion Sort.
Examples of algorithms that take advantage of Insertion Sort’s
near-best-case running time are <a href="10-glossary.html#shellsort"
class="term"
title="A sort that relies on the best-case cost of insertion sort to improve over $\Theta(n^2)$ worst case cost.">Shellsort</a>
and <a href="2.11-quicksort.html#quicksort">Quicksort</a>.</p>
<p>Counting comparisons or swaps yields similar results. Each time
through the inner <code>for</code> loop yields both a comparison and a
swap, except the last (i.e., the comparison that fails the inner
<code>for</code> loop’s test), which has no swap. Thus, the number of
swaps for the entire sort operation is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math>
less than the number of comparisons. This is 0 in the best case, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Theta(n^2)</annotation></semantics></math>
in the average and worst cases.</p>
<p>Later we will see algorithms whose growth rate is much better than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Theta(n^2)</annotation></semantics></math>.
Thus for larger arrays, Insertion Sort will not be so good a performer
as other algorithms. So Insertion Sort is not the best sorting algorithm
to use in most situations. But there are special situations where it is
ideal. We already know that Insertion Sort works great when the input is
sorted or nearly so. Another good time to use Insertion Sort is when the
array is very small, since Insertion Sort is so simple. The algorithms
that have better asymptotic growth rates tend to be more complicated,
which leads to larger constant factors in their running time. That means
they typically need fewer comparisons for larger arrays, but they cost
more per comparison. This observation might not seem that helpful, since
even an algorithm with high cost per comparison will be fast on small
input sizes. But there are times when we might need to do many, many
sorts on very small arrays. You should spend some time right now trying
to think of a situation where you will need to sort many small arrays.
Actually, it happens a lot.</p>
<p>
<div id="InssortSumm" class="embedContainer">
<iframe id="InssortSumm_iframe" aria-label="InssortSumm" src="../interactive/Sorting/InssortSumm.html" width="100%" height="600" scrolling="no">
Your browser does not support iframes.
</iframe>
</div>
</p>
<p>See for a discussion on how the relative costs of search and insert
can affect what is the best sort algorithm to use.</p>
<p>See <a
href="http://computationaltales.blogspot.com/2011/04/why-tailors-use-insertion-sort.html">Computational
Fairy Tales: Why Tailors Use Insertion Sort</a> for a discussion on how
the relative costs of search and insert can affect what is the best sort
algorithm to use.</p>
</section>
</section>
</main>

<footer>
<nav class="sitenav">
<div class="navlink">
<a href="2.3-sorting-terminology-and-notation.html" class="navbutton">&lt;&lt;</a>
<a href="2.3-sorting-terminology-and-notation.html" accesskey="p" rel="previous">Sorting Terminology and Notation</a>
</div>
<div class="navlink">
<a href="2.5-bubble-sort-optional.html" accesskey="n" rel="next">Bubble Sort (optional)</a>
<a href="2.5-bubble-sort-optional.html" class="navbutton">&gt;&gt;</a>
</div>
</nav>
</footer>

<script type="text/javascript" src="../interactive/Sorting/insertionsortCON.js"></script>
<script type="text/javascript" src="../interactive/Sorting/InsertionSortWorstCaseCON.js"></script>
<script type="text/javascript" src="../interactive/Sorting/InsertionSortBestCaseCON.js"></script>
<script type="text/javascript" src="../interactive/Sorting/InsertionSortAverageCaseCON.js"></script>
</body>
</html>

